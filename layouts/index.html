{{- define "main" }}
{{- $s := .Site.Params }}
{{- $p := .Params }}
{{- $scratch := newScratch }}
{{- if isset $p "image" }}
  {{- $scratch.Set "image" $p.image }}
{{- else }}
  {{ $scratch.Set "image" $s.fallBackOgImage }}
{{- end }}
{{- $image := $scratch.Get "image" }}
{{- $bg := absLangURL (path.Join "images" $image) }}
{{ $taxonomyObject := .Site.Taxonomies.active }}
{{ $uniqueCountries := slice }}
{{ range .Site.RegularPages }}
    {{ $pageCountries := .Params.geographies }}
    {{ range $pageCountries }}
        {{ if not (in $uniqueCountries .) }}
            {{ $uniqueCountries = $uniqueCountries | append . }}
        {{ end }}
    {{ end }}
{{ end }}
<div class="{{ if ne $p.singleColumn true }}grid-inverse {{ end }}wrap content">
  <article class="post_content">
  <h2 class="membersCounter"><strong>{{ $taxonomyObject.Count "true" }}</strong> members in <strong>{{ len $uniqueCountries }}</strong> countries</h2>
    <div class="post_body">
      {{- .Content }}
      
    </div>

    {{- $showRelatedInArticle := true }}
    {{- if eq $s.showRelatedInArticle false }}
      {{- $showRelatedInArticle = false }}
    {{- else if eq $p.showRelatedInArticle false }}
      {{- $showRelatedInArticle = false }}
    {{- end }}
    {{- if ne $showRelatedInArticle false }}
      {{- partial "related" . }}
    {{- end }}

    {{- $showComments := true }}
    {{- if eq $s.comments false }}
      {{- $showComments = false }}
    {{- else if eq $p.comments false }}
      {{- $showComments = false }}
    {{- end }}
    {{- if ne $showComments false }}
      {{- partial "comments" . }}
    {{- end }}
    {{- partial "i18nlist" . }}

  </article>
  {{- if ( ne $p.sidebar false ) }}
    {{- partial "sidebar" . }}
  {{ end }}
</div>
{{- end }}
